<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Album Disagreement Loss</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      padding: 2rem;
    }
    canvas {
      max-height: 600px;
      background: #fff;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    #album-list {
      margin-top: 2rem;
      padding-left: 0;
      list-style: none;
      max-width: 800px;
    }
    #album-list li {
      font-size: 1.1rem;
      margin: 0.4rem 0;
      cursor: pointer;
    }
    #album-list li:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>Disagreement Loss per Album</h1>
  <canvas id="lossChart" width="800" height="400"></canvas>

  <h2>Album List</h2>
  <ul id="album-list"></ul>

  <script>
    fetch('albums.json')
      .then(response => response.json())
      .then(data => {
        const ctx = document.getElementById('lossChart').getContext('2d');

        // Use numerical x-axis labels: 1, 2, 3...
        const xLabels = data.map((_, i) => i + 1);

        new Chart(ctx, {
          type: 'line',
          data: {
            labels: xLabels,
            datasets: [
              {
                label: 'Yagiz vs Tugba',
                data: data.map(d => d.loss_y_vs_t),
                borderColor: '#3e95cd',
                backgroundColor: '#3e95cd',
                fill: false,
                tension: 0.2,
                pointRadius: 5
              },
              {
                label: 'Yagiz vs Spotify',
                data: data.map(d => d.loss_y_vs_s),
                borderColor: '#e91e63', // red
                backgroundColor: '#e91e63',
                fill: false,
                tension: 0.2,
                pointRadius: 5
              },
              {
                label: 'Tugba vs Spotify',
                data: data.map(d => d.loss_t_vs_s),
                borderColor: '#4caf50', // green
                backgroundColor: '#4caf50',
                fill: false,
                tension: 0.2,
                pointRadius: 5
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' },
              tooltip: { mode: 'index' }
            },
            scales: {
              x: {
                ticks: {
                  callback: function(value, index) {
                    return index % 2 === 0
                      ? `${index + 1}` // Red
                      : `${index + 1}`; // Green
                  },
                  color: function(context) {
                    return context.index % 2 === 0 ? '#e91e63' : '#4caf50';
                  }
                },
                title: {
                  display: true,
                  text: 'Album Index',
                  font: { weight: 'bold' }
                }
              },
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: 'Loss Value',
                  font: { weight: 'bold' }
                }
              }
            }
          }
        });

        // Build album list
        const albumList = document.getElementById('album-list');
        albumList.innerHTML = data.map((album, idx) => {
          const color = idx % 2 === 0 ? '#e91e63' : '#4caf50';
          const albumSlug = album.album.toLowerCase().replace(/ /g, '-').replace(/[^\w-]/g, '');
          return `<li style="color: ${color};" onclick="window.location.href='album.html?album=${albumSlug}'">
            ${idx + 1}. ${album.album}
          </li>`;
        }).join('');
      });
  </script>
</body>
</html>